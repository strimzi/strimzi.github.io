<div class="year-tabs">

  <div class="year-tabs" role="tablist" aria-label="Presentation years">
    
    {% comment %} Create tabs by year {% endcomment %}
    {% for year_entry in site.data.presentations.years %}
      {% assign year = year_entry[0] %}
      <button role="tab" aria-selected="{% if forloop.first %}true{% else %}false{% endif %}" aria-controls="panel-{{ year }}" id="tab-{{ year }}" class="tab">{{ year }}</button>
    {% endfor %}
    
    <button role="tab" aria-selected="false" aria-controls="panel-series" id="tab-series" class="tab">What's New series</button>
  </div>

  <div class="panels">

    {% comment %} Create a panel for each year {% endcomment %}
    {% for year_entry in site.data.presentations.years %}
      {% assign year = year_entry[0] %}
      {% assign talks = year_entry[1] %}
      <section class="tab-panel" id="panel-{{ year }}" aria-labelledby="tab-{{ year }}" role="tabpanel" {% unless forloop.first %}hidden{% endunless %}>
        <table class="talk-table">
          <thead>
            <tr><th scope="col">Date</th><th scope="col">Event</th><th scope="col">Title</th><th scope="col">Resources</th></tr>
          </thead>
          <tbody>
            {% for talk in talks %}
            <tr>
              <td data-label="Date">{{ talk.date }}</td>
              <td data-label="Event">{{ talk.event }}</td>
              <td data-label="Title">{{ talk.title }}</td>
              <td data-label="Resources">
                {% if talk.recording_url %}<a class="pill pill-link" href="{{ talk.recording_url }}" target="_blank" rel="noopener">Recording</a>{% endif %}
                {% if talk.playlist_url %}<a class="pill pill-link" href="{{ talk.playlist_url }}" target="_blank" rel="noopener">Playlist</a>{% endif %}
                {% if talk.slides_url %}<a class="pill pill-link" href="{{ talk.slides_url }}" target="_blank" rel="noopener">Slides</a>{% endif %}
                {% if talk.demo_url %}<a class="pill pill-link" href="{{ talk.demo_url }}" target="_blank" rel="noopener">Demo</a>{% endif %}
                {% if talk.repo_url %}<a class="pill pill-link" href="{{ talk.repo_url }}" target="_blank" rel="noopener">Repo</a>{% endif %}
                {% if talk.slides_unavailable %}<span class="pill pill-na">Slides unavailable</span>{% endif %}
                {% if talk.recording_unavailable %}<span class="pill pill-na">Recording unavailable</span>{% endif %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </section>
    {% endfor %}
    
    {% comment %} What's new series {% endcomment %}
    <section class="tab-panel" id="panel-series" aria-labelledby="tab-series" role="tabpanel" hidden>
      <table class="talk-table">
        <thead>
          <tr><th scope="col">Date</th><th scope="col">Event</th><th scope="col">Title</th><th scope="col">Resources</th></tr>
        </thead>
        <tbody>
          {% for talk in site.data.presentations.series %}
          <tr>
            <td data-label="Date">{{ talk.date }}</td>
            <td data-label="Event">{{ talk.event }}</td>
            <td data-label="Title">{{ talk.title }}</td>
            <td data-label="Resources">
              {% if talk.playlist_url %}<a class="pill pill-link" href="{{ talk.playlist_url }}" target="_blank" rel="noopener">Playlist</a>{% endif %}
              {% if talk.repo_url %}<a class="pill pill-link" href="{{ talk.repo_url }}" target="_blank" rel="noopener">Repo</a>{% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </section>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const tabContainer = document.querySelector('.year-tabs');
  const tabs = tabContainer.querySelectorAll('[role="tab"]');
  
  tabs.forEach(tab => {
    tab.addEventListener('click', function() {
      // Remove active state from tabs
      tabs.forEach(t => t.setAttribute('aria-selected', 'false'));
      
      // Hide all panels
      document.querySelectorAll('.tab-panel').forEach(panel => {
        panel.hidden = true;
      });
      
      // Activate tab
      this.setAttribute('aria-selected', 'true');
      
      // Show panel
      const panelId = this.getAttribute('aria-controls');
      document.getElementById(panelId).hidden = false;
    });
  });
});
</script>